<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="ChatSK_files/filelist.xml">
<link rel=Edit-Time-Data href="ChatSK_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Bruno Sonnino</o:Author>
  <o:LastAuthor>Bruno Sonnino</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>22</o:TotalTime>
  <o:Created>2024-10-05T13:20:00Z</o:Created>
  <o:LastSaved>2024-10-05T13:20:00Z</o:LastSaved>
  <o:Pages>12</o:Pages>
  <o:Words>2651</o:Words>
  <o:Characters>15116</o:Characters>
  <o:Lines>125</o:Lines>
  <o:Paragraphs>35</o:Paragraphs>
  <o:CharactersWithSpaces>17732</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="ChatSK_files/themedata.thmx">
<link rel=colorSchemeMapping href="ChatSK_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackRevisions/>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]--><![if !supportAnnotations]>
<style id="dynCom" type="text/css"><!-- --></style>
<script language="JavaScript"><!--
function msoCommentShow(anchor_id, com_id)
{
	if(msoBrowserCheck()) 
		{
		c = document.all(com_id);
		a = document.all(anchor_id);
		if (null != c && null == c.length && null != a && null == a.length)
			{
			var cw = c.offsetWidth;
			var ch = c.offsetHeight;
			var aw = a.offsetWidth;
			var ah = a.offsetHeight;
			var x  = a.offsetLeft;
			var y  = a.offsetTop;
			var el = a;
			while (el.tagName != "BODY") 
				{
				el = el.offsetParent;
				x = x + el.offsetLeft;
				y = y + el.offsetTop;
				}
			var bw = document.body.clientWidth;
			var bh = document.body.clientHeight;
			var bsl = document.body.scrollLeft;
			var bst = document.body.scrollTop;
			if (x + cw + ah / 2 > bw + bsl && x + aw - ah / 2 - cw >= bsl ) 
				{ c.style.left = x + aw - ah / 2 - cw; }
			else 
				{ c.style.left = x + ah / 2; }
			if (y + ch + ah / 2 > bh + bst && y + ah / 2 - ch >= bst ) 
				{ c.style.top = y + ah / 2 - ch; }
			else 
				{ c.style.top = y + ah / 2; }
			c.style.visibility = "visible";
}	}	}
function msoCommentHide(com_id) 
{
	if(msoBrowserCheck())
		{
		c = document.all(com_id);
		if (null != c && null == c.length)
		{
		c.style.visibility = "hidden";
		c.style.left = -1000;
		c.style.top = -1000;
		} } 
}
function msoBrowserCheck()
{
	ms = navigator.appVersion.indexOf("MSIE");
	vers = navigator.appVersion.substring(ms + 5, ms + 6);
	ie4 = (ms > 0) && (parseInt(vers) >= 4);
	return ie4;
}
if (msoBrowserCheck())
{
	document.styleSheets.dynCom.addRule(".msocomanchor","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomoff","display: none");
	document.styleSheets.dynCom.addRule(".msocomtxt","visibility: hidden");
	document.styleSheets.dynCom.addRule(".msocomtxt","position: absolute");
	document.styleSheets.dynCom.addRule(".msocomtxt","top: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","left: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","width: 33%");
	document.styleSheets.dynCom.addRule(".msocomtxt","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomtxt","color: infotext");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-top: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-right: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-bottom: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-left: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","padding: 3pt 3pt 3pt 3pt");
	document.styleSheets.dynCom.addRule(".msocomtxt","z-index: 100");
}
// --></script>
<![endif]>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:"Aptos Display";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 3 0 0 415 0;}
@font-face
	{font-family:Aptos;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 3 0 0 415 0;}
@font-face
	{font-family:"Cascadia Mono";
	panose-1:2 11 6 9 2 0 0 2 0 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1593824513 1073805819 262144 0 511 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:.25in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h2
	{mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
h5
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 5 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 6 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 7 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 8 Char";
	mso-style-next:Normal;
	margin:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 9 Char";
	mso-style-next:Normal;
	margin:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Subtitle Char";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#467886;
	mso-themecolor:hyperlink;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:#96607D;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-parent:"";
	margin:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Quote Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Intense Quote Char";
	mso-style-next:Normal;
	margin-top:.25in;
	margin-right:.6in;
	margin-bottom:.25in;
	margin-left:.6in;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #0F4761 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-top-themeshade:191;
	mso-border-bottom-alt:solid #0F4761 .5pt;
	mso-border-bottom-themecolor:accent1;
	mso-border-bottom-themeshade:191;
	padding:0in;
	mso-padding-alt:10.0pt 0in 10.0pt 0in;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
span.MsoIntenseEmphasis
	{mso-style-priority:21;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.MsoIntenseReference
	{mso-style-priority:32;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-variant:small-caps;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	letter-spacing:.25pt;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:20.0pt;
	mso-bidi-font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 5";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 6";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 7";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 8";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 9";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Subtitle;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Quote;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Intense Quote";
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Comment Text";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:12.0pt;
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:132873807;
	mso-list-type:hybrid;
	mso-list-template-ids:-866743488 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1
	{mso-list-id:1634821688;
	mso-list-template-ids:-1574407804;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin-top:0in;
	mso-para-margin-right:0in;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link="#467886" vlink="#96607D" style='tab-interval:.5in;
word-wrap:break-word'>

<div class=WordSection1>

<h1>Creating a WinUI3 Chat application with the Phi-3 model with Semantic
Kernel</h1>

<p class=MsoNormal>The release of ChatGPT in November 2022 introduced a
revolution in the way we do things: from that date, we had an assistant that
could help us in many tasks, like proofing text, writing, improving and
explaining code and many other tasks. Every day we see new ways to use it and
how to make it better for our needs.</p>

<p class=MsoNormal>Now, everybody is running to add AI features in their
programs, to make them easier to use, more adapted to the end user and more user
friendly.</p>

<p class=MsoNormal>One way to improve the programs is to add a chat feature,
where the user asks a question and the program answers in a conversational
mode. We can do this by leveraging the OpenAI API by allowing AI Conversations in
our apps. This is a very nice feature, but has some drawbacks:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>The
     OpenAI API is not free, and it could cost from thousands to millions of
     dollars to keep the program running, depending on scale.</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>The
     user would need to be connected to the Internet, and that could eventually
     also add latency to the first token generation.</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>If used
     outside of Azure Cloud infrastructure, our data (maybe proprietary or
     user's information) would need to be sent to the servers out of our
     network, and that might not be compliant with data privacy policies and
     regulations.</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>The AI
     model would have limited options for customization</li>
</ul>

<p class=MsoNormal>To solve the above problems, the next option is to use an AI
model that can run in your local machine, without sending any data to cloud servers.
This AI Model could be any, including models that were trained exclusively for
the app, this model would fit perfectly to the app's needs or could even be a
pre-trained AI Model fine-tuned, improved for your scenarios.</p>

<p class=MsoNormal>In this article, we will show how to use the Semantic Kernel
to develop a WinUI3 chat application that connects to a local Phi-3 model and
allows the user to chat with the model.</p>

<h2>What is Semantic Kernel</h2>

<p class=MsoNormal><a
href="https://learn.microsoft.com/en-us/semantic-kernel/overview/">Semantic
Kernel</a>&nbsp;is a lightweight, open-source development kit that lets you
easily build AI agents. You can write code in C#, Python, or Java and connect
to models in many different platforms, like OpenAI, Azure, Google, Mistral or
Hugging Face.</p>

<p class=MsoNormal>Until now, to leverage SLMs (Small language models) in your
machine the only way possible was using a local hosted service. That means
that, to use a model, you would need to have a service with an API that would
be used to connect the client and the server. That posed a limitation: if you
wanted to run a model locally in your machine, you would need to setup a
service, like&nbsp;<a href="https://ollama.com/">Ollama</a>&nbsp;or&nbsp;<a
href="https://lmstudio.ai/">LM Studio</a>&nbsp;to load and serve the model in
your machine to be available thru Semantic Kernel. Some of those services (like
Ollama) even allow you to run them in a container, making it a bit easier to <span
class=GramE>setup</span> and distribute but that still isnt the ideal approach.</p>

<p class=MsoNormal>Recently, the Semantic Kernel team launched the <a
href="https://github.com/microsoft/semantic-kernel/tree/main/dotnet/src/Connectors/Connectors.Onnx"><span
class=SpellE>Onnx</span> Connector</a>&nbsp;that leverages the latest ONNX
GenAI runtime and allows you to connect to an <span class=SpellE>Onnx</span> capable
SLM <span style='mso-spacerun:yes'></span>located in your machine (normally
represented by files, without the need to setup any service or http protocol to
interact with the AI Model. All you need to do is to download the model files into
your machine and point to its location to use it with Semantic Kernel.</p>

<h2>What is Phi-3 ONNX</h2>

<p class=MsoNormal><a
href="https://azure.microsoft.com/en-us/blog/introducing-phi-3-redefining-whats-possible-with-slms/">Phi-3</a>&nbsp;is
a family of Microsofts <span class=GramE>Open Source</span> Small Language
Models (SLMs), available in many different platform catalogs in Azure AI Studio,
Hugging Face that allows you to download and run in the user's machine.
Depending on the selected model, the memory requirements may be too high for
the average user, but there are many options of small models that can be the
right fit for a medium-sized machine. To know more about it, you can check
the&nbsp;<a href="https://github.com/microsoft/Phi-3CookBook">Phi-3 Cookbook</a>,
with plenty of information on how to set it up and run it.</p>

<p class=MsoNormal>To use it, you normally download the model from a catalog
like Hugging Face, hosted in a git versioning repository. Some ways include opening
a terminal window, going to the location where you want to download the model
and clone it with a git the command (you may need to install the git large file
storage at https://git-lfs.com/):</p>

<p class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
"Cascadia Mono";mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>git clone
https://huggingface.co/microsoft/Phi-3-mini-4k-instruct-onnx<o:p></o:p></span></p>

<p class=MsoNormal>Once you have cloned the repository, you will notice see
that there are different directories for what type of processing technology you
want your model to run on (GPU, CPU):</p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_2" o:spid="_x0000_i1028" type="#_x0000_t75"
 alt="A screenshot of a computer&#10;&#10;Description automatically generated"
 style='width:468pt;height:225.6pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="ChatSK_files/image001.png" o:title="A screenshot of a computer&#10;&#10;Description automatically generated"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=301
src="ChatSK_files/image002.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"
v:shapes="Picture_x0020_2"><![endif]></span></p>

<p class=MsoNormal>According to the model card, the available versions are:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-style:italic'><span style='mso-list:Ignore'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><i>ONNX
model for int4 DML: ONNX model for AMD, Intel, and NVIDIA GPUs on Windows,
quantized to int4 using AWQ.<o:p></o:p></i></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-style:italic'><span style='mso-list:Ignore'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><i>ONNX
model for fp16 CUDA: ONNX model you can use to run for your NVIDIA GPUs.<o:p></o:p></i></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-style:italic'><span style='mso-list:Ignore'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><i>ONNX
model for int4 CUDA: ONNX model for NVIDIA GPUs using int4 quantization via
RTN.<o:p></o:p></i></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-style:italic'><span style='mso-list:Ignore'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><i>ONNX
model for int4 CPU and Mobile: ONNX model for CPU and mobile using int4
quantization via RTN. There are two versions uploaded to balance latency vs.
accuracy. Acc=1 is targeted at improved accuracy, while Acc=4 is for improved
perf. For mobile devices, we recommend using the model with acc-level-4.<o:p></o:p></i></p>

<p class=MsoNormal>For this example, we will use the CPU version (<span
class=SpellE>cpu_and_mobile</span>/cpu-int4-rtn-block-32-acc-level-4). This
option will not use the GPU or the NPU in the machine, this example was chosen because
it will work in most of the scenarios. The other versions may require a
specific type of GPU or NPU capable machines.</p>

<h2>Creating the project</h2>

<p class=MsoNormal>We will create a WinUi3 project for the chat. In Visual
Studio, create a new&nbsp;<i>Blank App, Packaged (<span class=SpellE>WinUI</span>
3 in Desktop).</i>&nbsp;This app has a single button that changes the content
when it's clicked.</p>

<p class=MsoNormal>The first step is to add the NuGet packages for the Semantic
Kernel and the <span class=SpellE>Onnx</span> Connector. Right click the&nbsp;<i>Dependencies</i>&nbsp;node
in Solution Explorer and select&nbsp;<i>Manage NuGet Packages</i>. Add
the&nbsp;<a style='mso-comment-reference:BS_2;mso-comment-date:20241004T0754;
mso-comment-parent:1'></a><a style='mso-comment-reference:RB_1;mso-comment-date:
20241004T1250'><span style='mso-comment-continuation:2'><b>Microsoft.SemanticKernel.Core</b></span></a><span
style='mso-comment-continuation:2'><![if !supportAnnotations]><a
class=msocomanchor id="_anchor_1"
onmouseover="msoCommentShow('_anchor_1','_com_1')"
onmouseout="msoCommentHide('_com_1')" href="#_msocom_1" language=JavaScript
name="_msoanchor_1">[RB1]</a><![endif]><span style='mso-special-character:comment'>&nbsp;</span></span><![if !supportAnnotations]><a
class=msocomanchor id="_anchor_2"
onmouseover="msoCommentShow('_anchor_2','_com_2')"
onmouseout="msoCommentHide('_com_2')" href="#_msocom_2" language=JavaScript
name="_msoanchor_2">[BS2]</a><![endif]><span style='mso-special-character:comment'>&nbsp;</span>&nbsp;and&nbsp;<b>Microsoft.SemanticKernel.Connectors.Onnx</b>&nbsp;packages.</p>

<p class=MsoNormal>Then, we will create the code for the chat. In&nbsp;<span
class=SpellE><i>MainWindow.xaml.cs</i></span>, add the following code:</p>

<p class=MsoNormal style='margin-bottom:0in'><span style='mso-spacerun:yes'>
</span><span style='font-size:10.0pt;line-height:115%;font-family:"Cascadia Mono";
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
sealed partial class <span class=SpellE>MainWindow</span> : Window<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>private Kernel _kernel;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public <span class=SpellE>MainWindow</span>()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>this.InitializeComponent</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>InitializeSemanticKernel</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>#pragma warning disable SKEXP0070 // Type is
for evaluation purposes only and is subject to change or removal in future
updates. Suppress this diagnostic to proceed.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>private void <span class=SpellE>InitializeSemanticKernel</span>()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>_kernel = <span class=SpellE>Kernel.CreateBuilder</span>() <o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span></span><span style='mso-ansi-language:EN-US !msorm'><span lang=FR
style='font-size:10.0pt;line-height:115%;font-family:"Cascadia Mono";
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'>.<span
class=SpellE>AddOnnxRuntimeGenAIChatCompletion</span>(&quot;phi-3&quot;,
@&quot;C:\AIModels\microsoft--Phi-3-mini-4k-instruct-onnx\main\cpu_and_mobile\cpu-int4-rtn-block-32-acc-level-4&quot;)<o:p></o:p></span></span></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='mso-ansi-language:
EN-US !msorm'><span lang=FR style='font-size:10.0pt;line-height:115%;
font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'><span
style='mso-spacerun:yes'> </span></span></span></span><span
style='font-size:10.0pt;line-height:115%;font-family:"Cascadia Mono";
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Build();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal>In the main class, we declared a private field&nbsp;<i>_kernel</i>,
that will store the kernel used for the chat. The kernel is the central
component of Semantic <span class=GramE>Kernel</span> and it could be seen as a
Dependency Injection container that manages all of the services and plugins
necessary to run your AI application. You will provide the services needed for
the application, so they can be used in your application.</p>

<p class=MsoNormal>In our case, we are using the&nbsp;<span class=SpellE><i>AddOnnxRuntimeGenAIChatCompletion</i></span>&nbsp;service,
that is available as part of the <span class=SpellE>Onnx</span> connector. We
must pass the model identifier (normally a name like phi-3) and the path to
the directory where the model files are located. If you need to change to a
different ONNX model in the future, is very easy: all needed is just to supply <span
class=GramE>different</span> name and path of the new model to be used.</p>

<p class=MsoNormal>For the UI, you can add this code in&nbsp;<span
class=SpellE><i>MainWindow.xaml</i></span>:</p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;Grid&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>Grid.RowDefinitions</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>RowDefinition</span> Height=&quot;*&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>RowDefinition</span> Height=&quot;Auto&quot;
/&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>Grid.RowDefinitions</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>Grid.Resources</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Style x:Key=&quot;CardPanelStyle&quot; <span class=SpellE>TargetType</span>=&quot;<span
class=SpellE>StackPanel</span>&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>Style.Setters</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;Padding&quot; Value=&quot;12&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;Background&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Value=&quot;{<span
class=SpellE>ThemeResource</span> <span class=SpellE>CardBackgroundFillColorDefaultBrush</span>}&quot;
/&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;<span class=SpellE>BorderThickness</span>&quot;
Value=&quot;1&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;<span class=SpellE>BorderBrush</span>&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Value=&quot;{<span
class=SpellE>ThemeResource</span> <span class=SpellE>CardStrokeColorDefaultBrush</span>}&quot;
/&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;<span class=SpellE>CornerRadius</span>&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Value=&quot;{<span
class=SpellE>StaticResource</span> <span class=SpellE>OverlayCornerRadius</span>}&quot;
/&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>Style.Setters</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/Style&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>local:ChatTemplateSelector</span>
x:Key=&quot;ChatTemplateSelector&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>AssistantTemplate</span>=&quot;{<span class=SpellE>StaticResource</span>
<span class=SpellE>AssistantDataTemplate</span>}&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>SystemTemplate</span>=&quot;{<span class=SpellE>StaticResource</span>
<span class=SpellE>SystemDataTemplate</span>}&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>UserTemplate</span>=&quot;{<span class=SpellE>StaticResource</span>
<span class=SpellE>UserDataTemplate</span>}&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>DataTemplate</span>
x:Key=&quot;UserDataTemplate&quot; x:DataType=&quot;local:ChatMessage&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>StackPanel</span> <span class=SpellE>MaxWidth</span>=&quot;486&quot;
<span class=SpellE>HorizontalAlignment</span>=&quot;Right&quot;
Spacing=&quot;8&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Style=&quot;{<span
class=SpellE>StaticResource</span> <span class=SpellE>CardPanelStyle</span>}&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>TextBlock</span> <span class=SpellE>IsTextSelectionEnabled</span>=&quot;True&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Text=&quot;{<span
class=SpellE>x:Bind</span> Content, Mode=<span class=SpellE>OneWay</span>}&quot;
<span class=SpellE>TextWrapping</span>=&quot;Wrap&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>StackPanel</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>DataTemplate</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>DataTemplate</span>
x:Key=&quot;AssistantDataTemplate&quot;
x:DataType=&quot;local:ChatMessage&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Grid Margin=&quot;0,4&quot; <span class=SpellE>HorizontalAlignment</span>=&quot;Left&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>StackPanel</span> <span class=SpellE>MaxWidth</span>=&quot;486&quot;
<span class=SpellE>HorizontalAlignment</span>=&quot;Right&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Background=&quot;{<span
class=SpellE>ThemeResource</span> <span class=SpellE>AccentFillColorDefaultBrush</span>}&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Spacing=&quot;8&quot;
Style=&quot;{<span class=SpellE>StaticResource</span> <span class=SpellE>CardPanelStyle</span>}&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>&lt;<span class=SpellE>TextBlock</span>
<span class=SpellE>HorizontalAlignment</span>=&quot;Right&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Foreground=&quot;{<span
class=SpellE>ThemeResource</span> <span class=SpellE>TextOnAccentFillColorPrimaryBrush</span>}&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span><span class=SpellE>IsTextSelectionEnabled</span>=&quot;True&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Text=&quot;{<span
class=SpellE>x:Bind</span> Content, Mode=<span class=SpellE>OneWay</span>}&quot;
<span class=SpellE>TextWrapping</span>=&quot;Wrap&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>StackPanel</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/Grid&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>DataTemplate</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>DataTemplate</span>
x:Key=&quot;SystemDataTemplate&quot;
x:DataType=&quot;local:ChatMessage&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Grid Margin=&quot;0,4&quot; <span class=SpellE>HorizontalAlignment</span>=&quot;Left&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>StackPanel</span> <span class=SpellE>MaxWidth</span>=&quot;486&quot;
<span class=SpellE>HorizontalAlignment</span>=&quot;Right&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>
</span>Background=&quot;Red&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Spacing=&quot;8&quot;
Style=&quot;{<span class=SpellE>StaticResource</span> <span class=SpellE>CardPanelStyle</span>}&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>&lt;<span class=SpellE>TextBlock</span>
<span class=SpellE>HorizontalAlignment</span>=&quot;Right&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Foreground=&quot;{<span
class=SpellE>ThemeResource</span> <span class=SpellE>TextOnAccentFillColorPrimaryBrush</span>}&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span><span class=SpellE>IsTextSelectionEnabled</span>=&quot;True&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span>Text=&quot;{<span
class=SpellE>x:Bind</span> Content, Mode=<span class=SpellE>OneWay</span>}&quot;
<span class=SpellE>TextWrapping</span>=&quot;Wrap&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>StackPanel</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/Grid&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>DataTemplate</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>Grid.Resources</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>ListView</span> x:Name=&quot;ChatListView&quot; <span
class=SpellE>ItemsSource</span>=&quot;{<span class=SpellE>x:Bind</span> <span
class=SpellE>ChatMessages</span>}&quot; <span class=SpellE>Grid.Row</span>=&quot;0&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>Margin=&quot;10&quot; <span class=SpellE>HorizontalContentAlignment</span>=&quot;Stretch&quot;
<span class=SpellE>ItemTemplateSelector</span>=&quot;{<span class=SpellE>StaticResource</span>
<span class=SpellE>ChatTemplateSelector</span>}&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ListView.ItemsPanel</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ItemsPanelTemplate</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ItemsStackPanel</span> <span class=SpellE>VerticalAlignment</span>=&quot;Bottom&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'> </span><span class=SpellE>ItemsUpdatingScrollMode</span>=&quot;<span
class=SpellE>KeepLastItemInView</span>&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>ItemsPanelTemplate</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>ListView.ItemsPanel</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ListView.ItemContainerStyle</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Style <span class=SpellE>TargetType</span>=&quot;<span class=SpellE>ListViewItem</span>&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Setter Property=&quot;<span class=SpellE>HorizontalContentAlignment</span>&quot;
Value=&quot;Stretch&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/Style&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>ListView.ItemContainerStyle</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>ListView</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Grid <span class=SpellE>Grid.Row</span>=&quot;1&quot;
Margin=&quot;10&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>Grid.ColumnDefinitions</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ColumnDefinition</span> Width=&quot;*&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ColumnDefinition</span> Width=&quot;Auto&quot;
/&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/<span class=SpellE>Grid.ColumnDefinitions</span>&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>TextBox</span> x:Name=&quot;UserInputBox&quot; <span
class=SpellE>PlaceholderText</span>=&quot;Type your message here...&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>Grid.Column</span>=&quot;0&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;Button Content=&quot;Send&quot; Click=&quot;<span class=SpellE>SendButton_Click</span>&quot;
<span class=SpellE>Grid.Column</span>=&quot;1&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>Margin=&quot;10,0,0,0&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>&lt;/Grid&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/Grid&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>At the bottom, we have a textbox and a button, so the user
can type the prompt and send the request. At the top, we have a <span
class=SpellE>listview</span>, where the messages will be displayed. We use a <span
class=SpellE>DataTemplateSelector</span> that will change the template,
depending on where the message comes from: the user (a white background box
right aligned), the assistant (a blue background box left aligned), or the
system (a red background box left aligned). The code for the <span
class=SpellE>DataTemplateSelector</span> must be added in a new file,
named&nbsp;<span class=SpellE><i>ChatTemplateSelector.cs</i></span>:</p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>internal class <span class=SpellE>ChatTemplateSelector</span>
: <span class=SpellE>DataTemplateSelector</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public <span class=SpellE>DataTemplate</span> <span class=SpellE>UserTemplate</span>
{ get; set; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public <span class=SpellE>DataTemplate</span> <span class=SpellE>SystemTemplate</span>
{ get; set; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public <span class=SpellE>DataTemplate</span> <span class=SpellE>AssistantTemplate</span>
{ get; set; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>protected override <span class=SpellE>DataTemplate</span> <span
class=SpellE>SelectTemplateCore</span>(object item)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>if (item is <span class=SpellE>ChatMessage</span> message)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span
style='mso-spacerun:yes'> </span><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return <span class=SpellE>message.Role</span>
switch<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>MessageRole.User</span> =&gt; <span class=SpellE>UserTemplate</span>,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>MessageRole.Assistant</span> =&gt; <span
class=SpellE>AssistantTemplate</span>,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span><span class=SpellE>MessageRole.System</span> =&gt; <span class=SpellE>SystemTemplate</span>,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>_ =&gt; <span class=SpellE>base.SelectTemplateCore</span>(item),<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>return <span class=SpellE>base.SelectTemplateCore</span>(item);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></p>

<p class=MsoNormal>This class will select the correct template, depending on
the role of the message. We must declare the class&nbsp;<span class=SpellE><i>ChatMessage</i></span>&nbsp;and
the <span class=SpellE>enum</span>&nbsp;<span class=SpellE><i>MessageRole</i></span>:</p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public <span class=SpellE>enum</span> <span
class=SpellE>MessageRole</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>User,
<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>Assistant, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>System<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class <span class=SpellE>ChatMessage</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public <span class=SpellE>MessageRole</span> Role { get; set; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>public string Content { get; set; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The last part is the code for the&nbsp;<i>Send</i>&nbsp;button,
where the prompt is sent to the model and the response is retrieved and sent to
the UI:</p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private <span class=SpellE>ObservableCollection</span>&lt;<span
class=SpellE>ChatMessage</span>&gt; <span class=SpellE>ChatMessages</span> {
get; set; } = new <span class=SpellE>ObservableCollection</span>&lt;<span
class=SpellE>ChatMessage</span>&gt;();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private async void <span class=SpellE>SendButton_Click</span>(object
sender, <span class=SpellE>RoutedEventArgs</span> e)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>string <span class=SpellE>userMessage</span> = <span class=SpellE>UserInputBox.Text</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>if (<span
class=SpellE>string.IsNullOrWhiteSpace</span>(<span class=SpellE>userMessage</span>))
return;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>//
Add user message to chat<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span><span
class=SpellE>ChatMessages.Add</span>(new <span class=SpellE>ChatMessage</span>
{ Role = <span class=SpellE>MessageRole.User</span>, Content = <span
class=SpellE>userMessage</span> });<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span><span
class=SpellE>UserInputBox.Text</span> = <span class=SpellE>string.Empty</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>try<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>// Get AI response<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>string response = await <span class=SpellE>GetAIResponseAsync</span>(<span
class=SpellE>userMessage</span>);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>// Add AI response to chat<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span><span
class=SpellE>ChatMessages.Add</span>(new <span class=SpellE>ChatMessage</span>
{ Role = <span class=SpellE>MessageRole.Assistant</span>, Content = response
});<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>catch
(Exception ex)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span><span
class=SpellE>ChatMessages.Add</span>(new <span class=SpellE>ChatMessage</span>
{ Role = <span class=SpellE>MessageRole.System</span>, Content = $&quot;Error:
{<span class=SpellE>ex.Message</span>}&quot; });<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>//
Scroll to the bottom of the chat<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>ChatListView.ScrollIntoView(ChatListView.Items[ChatListView.Items.Count
- 1]);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private async Task&lt;string&gt; <span
class=SpellE>GetAIResponseAsync</span>(string <span class=SpellE>userMessage</span>)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'> </span>var
result = await _<span class=SpellE>kernel.InvokePromptAsync</span>(<span
class=SpellE>userMessage</span>);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>
</span>return <span class=SpellE>result.GetValue</span>&lt;string&gt;().Trim();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in'><span style='font-size:10.0pt;
line-height:115%;font-family:"Cascadia Mono";mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>We declare a list of&nbsp;<span class=SpellE><i>ChatMessage</i></span>,
that will store the messages and will be shown in the <span class=SpellE>listview</span>.
The query of the model will be made in&nbsp;<span class=SpellE><i>GetAIResponseAsync</i></span>:
we call&nbsp;<span class=SpellE><i>kernel.InvokePromptAsync</i></span><i>(<span
class=SpellE>userMessage</span>)</i>&nbsp;and get the result and add it to the
list of messages. That's all we must do. Simple, no?</p>

<p class=MsoNormal>When we run the project, we get something like this:</p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_3" o:spid="_x0000_i1027" type="#_x0000_t75" alt="A screenshot of a computer&#10;&#10;Description automatically generated"
 style='width:423pt;height:324.6pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="ChatSK_files/image003.png" o:title="A screenshot of a computer&#10;&#10;Description automatically generated"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=564 height=433
src="ChatSK_files/image004.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"
v:shapes="Picture_x0020_3"><![endif]></span></p>

<p class=MsoNormal>Thats great, but it has some issues:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The chat response comes at once, while the users
are used to getting a streaming response, where the words come one-by-one</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>There is no history, that is, the chat has no
memory. If you would ask something like and how do I use it (referring to the
golden ratio), you would get:</p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" alt="A screenshot of a computer&#10;&#10;Description automatically generated"
 style='width:468pt;height:306pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="ChatSK_files/image005.png" o:title="A screenshot of a computer&#10;&#10;Description automatically generated"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=408
src="ChatSK_files/image006.jpg"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"
v:shapes="_x0000_i1026"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>We must add these features to the source code. In Semantic
Kernel, the answer is in the <span class=SpellE><i>ChatCompletionService</i></span>.
If we want to send a chat history and receive the answer in a streaming fashion,
we must get an instance of <span class=SpellE><i>IChatCompletionService</i></span>
from the Kernel instance with:</p>

<p class=MsoNormal><span style='font-size:9.5pt;line-height:115%;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'>_<span class=SpellE>chatCompletionService</span> = _<span class=SpellE>kernel.GetRequiredService</span>&lt;</span><span
class=SpellE><span style='font-size:9.5pt;line-height:115%;font-family:"Cascadia Mono";
color:#2B91AF;background:white;mso-highlight:white;mso-font-kerning:0pt'>IChatCompletionService</span></span><span
style='font-size:9.5pt;line-height:115%;font-family:"Cascadia Mono";color:black;
background:white;mso-highlight:white;mso-font-kerning:0pt'>&gt;();</span><span
style='font-size:9.5pt;line-height:115%;font-family:"Cascadia Mono";color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal>Once we get it, we can stream our messages providing a chat
history for context with:</p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>private</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> </span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>async</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:#2B91AF;background:white;mso-highlight:white;mso-font-kerning:0pt'>Task</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> <span class=SpellE>GetAIStreamResponseAsync</span>(</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:blue;background:white;
mso-highlight:white;mso-font-kerning:0pt'>string</span><span style='font-size:
9.5pt;font-family:"Cascadia Mono";color:black;background:white;mso-highlight:
white;mso-font-kerning:0pt'> <span class=SpellE>userMessage</span>)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><span class=SpellE>history.AddUserMessage</span>(<span
class=SpellE>userMessage</span>);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>var</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'> message
= </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";color:blue;
background:white;mso-highlight:white;mso-font-kerning:0pt'>new</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> </span><span class=SpellE><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:#2B91AF;background:
white;mso-highlight:white;mso-font-kerning:0pt'>ChatMessage</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> { Role = </span><span class=SpellE><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:#2B91AF;background:
white;mso-highlight:white;mso-font-kerning:0pt'>MessageRole</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'>.Assistant</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> };<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><span class=SpellE>ChatMessages.Add</span>(message);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>var</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'>
response = _<span class=SpellE>chatCompletionService.GetStreamingChatMessageContentsAsync</span>(<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><span class=SpellE>chatHistory</span>:
history,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>kernel: _kernel<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>var</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'> <span
class=SpellE>assistResponse</span> = </span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:#A31515;background:white;mso-highlight:white;
mso-font-kerning:0pt'>&quot;&quot;</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt'>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>await</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>foreach</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> (</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>var</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'> chunk </span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:blue;background:white;
mso-highlight:white;mso-font-kerning:0pt'>in</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt'> response)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span class=SpellE><span
style='mso-ansi-language:EN-US !msorm'><span lang=FR style='font-size:9.5pt;
font-family:"Cascadia Mono";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt;mso-ansi-language:FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'>assistResponse</span></span></span></span><span
style='mso-ansi-language:EN-US !msorm'><span lang=FR style='font-size:9.5pt;
font-family:"Cascadia Mono";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt;mso-ansi-language:FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'>
+= <span class=SpellE>chunk</span>;<o:p></o:p></span></span></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='mso-ansi-language:EN-US !msorm'><span
lang=FR style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;
background:white;mso-highlight:white;mso-font-kerning:0pt;mso-ansi-language:
FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'><span
style='mso-spacerun:yes'> </span><span class=SpellE>DispatcherQueue.TryEnqueue</span>(()
=&gt; <span class=SpellE>message.Content</span> += <span class=SpellE>chunk</span>);<o:p></o:p></span></span></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='mso-ansi-language:EN-US !msorm'><span
lang=FR style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;
background:white;mso-highlight:white;mso-font-kerning:0pt;mso-ansi-language:
FR'><span style='mso-prop-change:"Bruno Sonnino" 20241005T0906'><span
style='mso-spacerun:yes'> </span></span></span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><span class=SpellE>history.AddAssistantMessage</span>(<span
class=SpellE>assistResponse</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:9.5pt;line-height:115%;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'>}</span><span style='font-size:9.5pt;line-height:115%;font-family:"Cascadia Mono";
color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal>This should work fine, but in fact, it doesnt: the changes
in the message arent propagated to the UI. To make this work, we must
implement the <span class=SpellE><i>INotifyPropertyChanged</i></span> interface
and raise the event in the <span class=SpellE><i>ChatMessage</i></span> class:</p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>public</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> </span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>class</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span class=SpellE><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:#2B91AF;background:white;mso-highlight:white;mso-font-kerning:0pt'>ChatMessage</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> : </span><span class=SpellE><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:#2B91AF;background:
white;mso-highlight:white;mso-font-kerning:0pt'>INotifyPropertyChanged</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:#2B91AF;background:
white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>private</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>string</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> content;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>public</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span class=SpellE><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:#2B91AF;background:white;mso-highlight:white;mso-font-kerning:0pt'>MessageRole</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> Role { </span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:blue;background:white;
mso-highlight:white;mso-font-kerning:0pt'>get</span><span style='font-size:
9.5pt;font-family:"Cascadia Mono";color:black;background:white;mso-highlight:
white;mso-font-kerning:0pt'>; </span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:blue;background:white;mso-highlight:white;mso-font-kerning:
0pt'>set</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'>; }<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>public</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>string</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> Content {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>get</span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'> =&gt;
content;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>set<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>content = </span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:blue;background:white;
mso-highlight:white;mso-font-kerning:0pt'>value</span><span style='font-size:
9.5pt;font-family:"Cascadia Mono";color:black;background:white;mso-highlight:
white;mso-font-kerning:0pt'>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span><span class=SpellE><span
class=GramE>PropertyChanged</span></span><span class=GramE>?.</span>Invoke(</span><span
class=SpellE><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>this</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'>,</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>new</span></span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span class=SpellE><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:#2B91AF;background:white;mso-highlight:white;mso-font-kerning:0pt'>PropertyChangedEventArgs</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'>(</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:#A31515;background:white;mso-highlight:white;
mso-font-kerning:0pt'>&quot;Content&quot;</span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt'>));<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:black;background:white;mso-highlight:white;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'> </span></span><span style='font-size:9.5pt;
font-family:"Cascadia Mono";color:blue;background:white;mso-highlight:white;
mso-font-kerning:0pt'>public</span><span style='font-size:9.5pt;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'> </span><span style='font-size:9.5pt;font-family:"Cascadia Mono";
color:blue;background:white;mso-highlight:white;mso-font-kerning:0pt'>event</span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> </span><span class=SpellE><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:#2B91AF;background:
white;mso-highlight:white;mso-font-kerning:0pt'>PropertyChangedEventHandler</span></span><span
style='font-size:9.5pt;font-family:"Cascadia Mono";color:black;background:white;
mso-highlight:white;mso-font-kerning:0pt'> <span class=SpellE>PropertyChanged</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:9.5pt;line-height:115%;font-family:
"Cascadia Mono";color:black;background:white;mso-highlight:white;mso-font-kerning:
0pt'>}</span><span style='font-size:9.5pt;line-height:115%;font-family:"Cascadia Mono";
color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal>For every message, we are adding the user prompt and the
assistant message to the history and passing the history to the chat. That way,
we have a richer chat, that remembers the previous messages:</p>

<p class=MsoNormal><span style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_1" o:spid="_x0000_i1025" type="#_x0000_t75" style='width:468.6pt;
 height:366pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="ChatSK_files/image007.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=625 height=488
src="ChatSK_files/image008.jpg" v:shapes="Picture_x0020_1"><![endif]></span></p>

<h2>Conclusion</h2>

<p class=MsoNormal>As you can see, the Semantic Kernel eases AI development,
hiding complexities of the underlying framework, while giving flexibility to tweak
the usage. You can change models just by changing the path used, or you can
even change the platform, using a service like <a style='mso-comment-reference:
RB_3;mso-comment-date:20241004T1302'>OpenAI</a><![if !supportAnnotations]><a
class=msocomanchor id="_anchor_3"
onmouseover="msoCommentShow('_anchor_3','_com_3')"
onmouseout="msoCommentHide('_com_3')" href="#_msocom_3" language=JavaScript
name="_msoanchor_3">[RB3]</a><![endif]><span style='mso-special-character:comment'>&nbsp;</span>
just by changing a single line of code (in this case, you would also need to
add the <span class=SpellE>Microsoft.SemanticKernel.Connectors.OpenAI</span>
NuGet package to the project).</p>

</div>

<div style='mso-element:comment-list'><![if !supportAnnotations]>

<hr class=msocomoff align=left size=1 width="33%">

<![endif]>

<div style='mso-element:comment'><![if !supportAnnotations]>

<div id="_com_1" class=msocomtxt language=JavaScript
onmouseover="msoCommentShow('_anchor_1','_com_1')"
onmouseout="msoCommentHide('_com_1')"><![endif]><span style='mso-comment-author:
"Roger Barreto";mso-comment-providerid:AD;mso-comment-userid:"S\:\:rbarreto\@microsoft\.com\:\:1234bb3d-29ef-4c0b-a75d-98598697ba05"'><![if !supportAnnotations]><a
name="_msocom_1"></a><![endif]></span>

<p class=MsoNormal><span style='mso-special-character:comment'>&nbsp;<![if !supportAnnotations]><a
href="#_msoanchor_1" class=msocomoff>[RB1]</a><![endif]></span>Im changing to
Core, because if you use the SemanticKernel only bundle package it will include
unnecessarily both OpenAI and AzureOpenAI packages.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Core only includes the Abstractions which together are all
necessary packages to run the ONNX Connector</p>

<![if !supportAnnotations]></div>

<![endif]></div>

<div style='mso-element:comment'><![if !supportAnnotations]>

<div id="_com_2" class=msocomtxt language=JavaScript
onmouseover="msoCommentShow('_anchor_2','_com_2')"
onmouseout="msoCommentHide('_com_2')"><![endif]><span style='mso-comment-author:
"Bruno Sonnino";mso-comment-providerid:AD;mso-comment-userid:"S\:\:brunosonnino\@microsoft\.com\:\:dc707588-7cc2-4844-93a9-6f8b17cc7a3f"'><![if !supportAnnotations]><a
name="_msocom_2"></a><![endif]></span>

<p class=MsoNormal><span style='mso-special-character:comment'>&nbsp;<![if !supportAnnotations]><a
href="#_msoanchor_2" class=msocomoff>[BS2]</a><![endif]></span>That's great
info, thanks!</p>

<![if !supportAnnotations]></div>

<![endif]></div>

<div style='mso-element:comment'><![if !supportAnnotations]>

<div id="_com_3" class=msocomtxt language=JavaScript
onmouseover="msoCommentShow('_anchor_3','_com_3')"
onmouseout="msoCommentHide('_com_3')"><![endif]><span style='mso-comment-author:
"Roger Barreto";mso-comment-providerid:AD;mso-comment-userid:"S\:\:rbarreto\@microsoft\.com\:\:1234bb3d-29ef-4c0b-a75d-98598697ba05"'><![if !supportAnnotations]><a
name="_msocom_3"></a><![endif]></span>

<p class=MsoNormal><span style='mso-special-character:comment'>&nbsp;<![if !supportAnnotations]><a
href="#_msoanchor_3" class=msocomoff>[RB3]</a><![endif]></span>That's true, if
we remove the `Core` above that I mentioned, if you use the Core, the user will
need to add the Microsoft.SemanticKernel.Connectors.OpenAI to the project.</p>

<![if !supportAnnotations]></div>

<![endif]></div>

</div>

</body>

</html>
